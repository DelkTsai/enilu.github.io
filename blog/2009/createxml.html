<!DOCTYPE html>
<!--[if IE 8]> <html lang="en" class="ie8"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9"> <![endif]-->
<!--[if !IE]><!--> <html lang="en"> <!--<![endif]-->
<!-- BEGIN HEAD -->
<head>
    <meta charset="utf-8" />
    <title>enilu的技术博客 | java生成xml数据的一点困惑</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <meta content="技术博客,enilu的技术博客,java,xml" name="description" />
    <meta content="enilu的技术博客，欢迎批评指正,java生成xml数据的一点困惑" name="keywords">
    <meta content="enilu" name="author" />

   <!-- BEGIN GLOBAL MANDATORY STYLES -->          
   <link href="../../assets/plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
   <link href="../../assets/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
   <!-- END GLOBAL MANDATORY STYLES -->
   
   <!-- BEGIN PAGE LEVEL PLUGIN STYLES --> 
   <link href="../../assets/plugins/fancybox/source/jquery.fancybox.css" rel="stylesheet" />               
   <!-- END PAGE LEVEL PLUGIN STYLES -->

   <!-- BEGIN THEME STYLES --> 
   <link href="../../assets/css/style-metronic.css" rel="stylesheet" type="text/css"/>
   <link href="../../assets/css/style.css" rel="stylesheet" type="text/css"/>
   <link href="../../assets/css/themes/blue.css" rel="stylesheet" type="text/css" id="style_color"/>
   <link href="../../assets/css/style-responsive.css" rel="stylesheet" type="text/css"/>
   <link href="../../assets/css/custom.css" rel="stylesheet" type="text/css"/>
   <!-- END THEME STYLES -->

   <link rel="shortcut icon" href="favicon.ico" />
</head>
<!-- END HEAD -->

<!-- BEGIN BODY -->
<body>
	<!-- BEGIN STYLE CUSTOMIZER -->
	<div class="color-panel hidden-sm">
		<div class="color-mode-icons icon-color"></div>
		<div class="color-mode-icons icon-color-close"></div>
		<div class="color-mode">
			<p>THEME COLOR</p>
			<ul class="inline">
				<li class="color-blue current color-default" data-style="blue"></li>
				<li class="color-red" data-style="red"></li>
				<li class="color-green" data-style="green"></li>
				<li class="color-orange" data-style="orange"></li>
			</ul>
			<label>
				<span>Header</span>
				<select class="header-option form-control input-small">
					<option value="default" selected>Default</option>
					<option value="fixed">Fixed</option>
				</select>
			</label>
		</div>
	</div>
	<!-- END BEGIN STYLE CUSTOMIZER -->     
	
    <!-- BEGIN HEADER -->
    <div class="header navbar navbar-default navbar-static-top">
        <div class="container">
            <div class="navbar-header">
                <!-- BEGIN RESPONSIVE MENU TOGGLER -->
                <button class="navbar-toggle btn navbar-btn" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <!-- END RESPONSIVE MENU TOGGLER -->
                <!-- BEGIN LOGO (you can use logo image instead of text)-->
                <a class="navbar-brand logo-v1" href="index.html">
                    <img src="../../assets/img/logo_blue.png" id="logoimg" alt="" style="width:200px;height:60px">
                </a>
                <!-- END LOGO -->
            </div>
        
            <!-- BEGIN TOP NAVIGATION MENU -->
            <div class="navbar-collapse collapse">
                <ul class="nav navbar-nav">
                    <li><a href="../../index.html" target="_blank">首页</a></li>
                    <li class="active"><a href="../../index.html">博客</a></li>
                    <li><a href="../2015/hot_article.html">精选转载</a></li>
                    <li><a href="#">举个栗子</a></li>

                     
                    <li class="menu-search">
                        <span class="sep"></span>
                        <i class="fa fa-search search-btn"></i>

                        <div class="search-box">
                            <form action="#">
                                <div class="input-group input-large">
                                    <input class="form-control" type="text" placeholder="Search">
                                    <span class="input-group-btn">
                                        <button type="submit" class="btn theme-btn">Go</button>
                                    </span>
                                </div>
                            </form>
                        </div> 
                    </li>
                </ul>                           
            </div>
            <!-- BEGIN TOP NAVIGATION MENU -->
        </div>
    </div>
    <!-- END HEADER -->

    <!-- BEGIN PAGE CONTAINER -->  
    <div class="page-container">

        <!-- BEGIN BREADCRUMBS -->   
        <div class="row breadcrumbs margin-bottom-40">
              <div class="container">
                <div class="col-md-4 col-sm-4">
                    <h1>java生成xml数据的一点困惑</h1>
                </div>
                <div class="col-md-8 col-sm-8">
                    <ul class="pull-right breadcrumb">
                        <li><a href="../../index.html">首页</a></li>
                        <li><a href="../../index.html">博客</a></li>
                        <li class="active">文章详情</li>
                    </ul>
                </div>
            </div>
        </div>
        <!-- END BREADCRUMBS -->

		<!-- BEGIN CONTAINER -->   
		<div class="container min-hight">
			<!-- BEGIN BLOG -->
			<div class="row">
				<!-- BEGIN LEFT SIDEBAR -->            
				<div class="col-md-9 blog-item margin-bottom-40"> 
				 <p>
                     &nbsp;&nbsp;&nbsp;&nbsp;由于之前页面用的是ajax请求数据，后来想在页面再添加一个表格数据的时候也打算继续用这种方式：ajax提交后台组长xml数据返回，回调函数中用js解析xml生成表格。困惑来了，组装xml的时候本来我是这么做的：用一个StringBuilder然后一个一个节点在后面追加。最后用PrinterWriter将这个StringBuilder对象输出。写完之后觉得页面比较乱。<br><br>如下，代码具体内容大伙不必关注，只看下大致情形即可：
                        Java代码
<pre><code>
StringBuilder baseinfo = new StringBuilder("<?xml version='1.0' encoding='gb2312'?>");
baseinfo.append("<totaltable>");
baseinfo.append("<basetable>");
    //cpu使用信息
    baseinfo.append("<baseinfo name='CPU'>");
        baseinfo.append("<total>"+host.getCpufreq()+"</total>");
        double totalcpu = Double.parseDouble(host.getCpufreq().replace("G Hz", ""));
        double used = totalcpu*(Double.parseDouble(winbase.getCpuusage())/100);
        baseinfo.append("<used>"+nbf.format(used)+"GHz</used>");
        baseinfo.append("<usedpercent>"+winbase.getCpuusage()+"%</usedpercent>");
        baseinfo.append("</baseinfo>");
    //物理内存占用信息
    baseinfo.append("<baseinfo name='内存'>");
        baseinfo.append("<total>"+host.getTotalmem()+"</total>");

        double memused = (Double.parseDouble(winbase.getTotalphys())-(Double.parseDouble(winbase.getAvailphys())));
        nbf.setMaximumFractionDigits(2);//设置最大保留两位小数

        baseinfo.append("<used>"+nbf.format(memused/(1024*1024))+"MB</used>");
        baseinfo.append("<usedpercent>"+winbase.getMemoryload()+"%</usedpercent>");
        baseinfo.append("</baseinfo>");
    //虚拟内存信息
    double totalvirtual = Double.parseDouble(winbase.getTotalvirtual());
    baseinfo.append("<baseinfo name='交换空间'>");
        baseinfo.append("<total>"+nbf.format(totalvirtual/1024/1024)+"MB</total>");

        double swapused =  Double.parseDouble(winbase.getTotalvirtual())-(Double.parseDouble(winbase.getAvailvirtual()));
        baseinfo.append("<used>"+nbf.format(swapused/1024/1024)+"MB</used>");
        baseinfo.append("<usedpercent>"+ nbf.format(swapused/totalvirtual)+"%</usedpercent>");
        baseinfo.append("</baseinfo>");
    baseinfo.append("</basetable>");
//磁盘使用率信息
baseinfo.append("<disktable>");


    Hostdiskinfo disk = (Hostdiskinfo) disks.get(0);
    String[] diskinfos = disk.getHdiskinfo().split(";");

    for(int i=0;i<diskinfos.length;i++){
    String tmp[] = diskinfos[i].split(",");
    double diskused = Double.parseDouble(tmp[1]);
    double free = 100.0-diskused;

    baseinfo.append("<disk name='"+tmp[0]+"'>");
        baseinfo.append("<used>"+nbf.format(diskused)+"%</used>");
        baseinfo.append("<free>"+nbf.format(free)+"%</free>");
        baseinfo.append("<level>"+(diskused>70.0?"磁盘空间紧张":"磁盘空间富足")+"</level>");
        baseinfo.append("</disk>");
    }
    baseinfo.append("</disktable>");
baseinfo.append("</totaltable>");
</code>
</pre>



                        最后生成的xml文件格式如下：
                        Xml代码  收藏代码
<pre><xmp>
<?xml version='1.0' encoding='gb2312'?>
<totaltable>
    <basetable>
        <baseinfo name='CPU'>
            <total>1.6G Hz</total>
            <used>0.083GHz</used>
            <usedpercent>5.2%</usedpercent>
        </baseinfo>
        <baseinfo name='内存'>
            <total>2038MB</total>
            <used>1,304.57MB</used>
            <usedpercent>64%</usedpercent>
        </baseinfo>
        <baseinfo name='交换空间'>
            <total>2,047.88MB</total>
            <used>157.79MB</used>
            <usedpercent>0.08%</usedpercent>
        </baseinfo>
    </basetable>
    <disktable>
        <disk name='C:'>
            <used>40.2%</used>
            <free>59.8%</free>
            <level>磁盘空间富足</level>
        </disk>
        <disk name='D:'>
            <used>87.6%</used>
            <free>12.4%</free>
            <level>磁盘空间紧张</level>
        </disk>
        <disk name='E:'>
            <used>67.4%</used>
            <free>32.6%</free>
            <level>磁盘空间富足</level>
        </disk>
        <disk name='F:'>
            <used>58.2%</used>
            <free>41.8%</free>
            <level>磁盘空间富足</level>
        </disk>
    </disktable>
</totaltable>
</xmp></pre>


                    &nbsp;&nbsp;&nbsp;&nbsp;今天看到别人用extjs的时候用到xstream直接将java对象转换为xml数据，就想这里是否也可以这样用；<br>

                    &nbsp;&nbsp;&nbsp;&nbsp;首先上面这个xml中的数据不是一个类中获得的，那么肯定需要在根据该xml数据格式再定义一个java bean，然后根据业务逻辑将合适的值设置到这个java bean中，再转换。 不知道这么做有没有必要？因为看这满眼的sbinfo.append(".....")感觉很乱。<br>

                    &nbsp;&nbsp;&nbsp;&nbsp;不知道大伙一般做类似的工作的时候，是直接手动组装xml呢，还是用类似XStream这样的直接将java bean转换为xml的工具，如果都有的，那么使用各自不同的方法的依据是什么。<br>

                    </p>
				 
					<ul class="blog-info">
						<li><i class="fa fa-user"></i> By enilu</li>
						<li><i class="fa fa-calendar"></i> 17/10/2009</li>
						<li><i class="fa fa-comments"></i> 0</li>
						<li><i class="fa fa-tags"></i> java,dom4j,xml,</li>
					</ul>				 
				 
					 
					<div class="post-comment">
						 
						<form role="form">
							 
							<p><a class="btn btn-default theme-btn" href="mailto:eniluzt@qq.com">联系我</a></p>
						</form>
					</div>
				</div>
				<!-- END LEFT SIDEBAR -->

				<!-- BEGIN RIGHT SIDEBAR -->            
				<div class="col-md-3 blog-sidebar">
					<!-- CATEGORIES START -->
					<h2 class="no-top-space">文章列表</h2>
					<ul class="nav sidebar-categories margin-bottom-40">

					</ul>
					<!-- CATEGORIES END -->
					
					<!-- BEGIN RECENT NEWS -->                            
					<h2>热门文章</h2>
					 <div class="recent-news margin-bottom-10">
						<div class="row margin-bottom-10">
							 
							<div class="col-md-12 recent-news-inner">
								<h3><a href="#">Letiusto gnissimos</a></h3>
								<p>Decusamus tiusto odiodig nis simos ducimus qui sint</p>
							</div>                        
						</div>
						<div class="row margin-bottom-10">
							 
							<div class="col-md-12 recent-news-inner">
								<h3><a href="#">Letiusto gnissimos</a></h3>
								<p>Decusamus tiusto odiodig nis simos ducimus qui sint</p>
							</div>                        
						</div>
						<div class="row margin-bottom-10">
							 
							<div class="col-md-12 recent-news-inner">
								<h3><a href="#"></a></h3>
								<p></p>
							</div>                        
						</div>
						<div class="row margin-bottom-10">
							 
							<div class="col-md-12 recent-news-inner">
								<h3><a href="#"></a></h3>
								<p></p>
							</div>                        
						</div>
						<div class="row margin-bottom-10">
							 
							<div class="col-md-12 recent-news-inner">
								<h3><a href="#"></a></h3>
								<p></p>
							</div>                        
						</div>
						 
					</div> 
					<!-- END RECENT NEWS -->                            
 	 

					<!-- BEGIN BLOG TAGS -->
					<div class="blog-tags margin-bottom-20">
						<h2>热门标签</h2>
						<ul>

						</ul>
					</div>
					<!-- END BLOG TAGS -->
				</div>
				<!-- END RIGHT SIDEBAR -->            
			</div>
			<!-- END BEGIN BLOG -->
		</div>
		<!-- END CONTAINER -->

	</div>
    <!-- END BEGIN PAGE CONTAINER -->  
	
	
    <!-- BEGIN FOOTER -->
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-md-4 col-sm-4 space-mobile">
                    <!-- BEGIN ABOUT -->                    
                    <h2>关于我</h2>
                    <p class="margin-bottom-30">年近三十而不立；身为笨鸟而不先飞；知错而不悔改；空谈梦想而不行动；是也。</p>
                    <div class="clearfix"></div>                    
                    <!-- END ABOUT -->                               
                </div>
                <div class="col-md-4 col-sm-4 space-mobile">
                    <!-- BEGIN CONTACTS -->                                    
                    <h2>联系我</h2>
                    <address class="margin-bottom-40">
                       easecredit. <br />
                        北京.朝阳 <br />
                         
                        QQ:909051758 <br />
                        Email: <a href="mailto:eniluzt@qq.com">eniluzt@qq.com</a>                        
                    </address>
                                                   
                </div>
					<div class="col-md-4 col-sm-4 space-mobile">
                    <!-- BEGIN CONTACTS -->                                    
                    <h2>友情链接</h2>
                    <address class="margin-bottom-40">
                       网站使用metronic模版，感谢，<a target="_blank" href="http://themeforest.net/item/metronic-responsive-admin-dashboard-template/4021469">go to metronic</a>  </address>                                                   
                </div>
               
            </div>
        </div>
    </div>
    <!-- END FOOTER -->

    <!-- BEGIN COPYRIGHT -->
    <div class="copyright">
        <div class="container">
            <div class="row">
                <div class="col-md-8">
                    <p>
                        <span class="margin-right-10">2015 © eniluzt. ALL Rights Reserved.</span> 
                         
                    </p>
                </div>
                
            </div>
        </div>
    </div>
    <!-- END COPYRIGHT -->

    <!-- Load javascripts at bottom, this will reduce page load time -->
    <!-- BEGIN CORE PLUGINS(REQUIRED FOR ALL PAGES) -->
    <!--[if lt IE 9]>
    <script src="../../assets/plugins/respond.min.js"></script>  
    <![endif]-->  
    <script src="../../assets/plugins/jquery-1.10.2.min.js" type="text/javascript"></script>
    <script src="../../assets/plugins/jquery-migrate-1.2.1.min.js" type="text/javascript"></script>
    <script src="../../assets/plugins/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>      
    <script type="text/javascript" src="../../assets/plugins/hover-dropdown.js"></script>
    <script type="text/javascript" src="../../assets/plugins/back-to-top.js"></script>    
    <!-- END CORE PLUGINS -->

    <!-- BEGIN PAGE LEVEL JAVASCRIPTS(REQUIRED ONLY FOR CURRENT PAGE) -->
    <script type="text/javascript" src="../../assets/plugins/fancybox/source/jquery.fancybox.pack.js"></script>  
    <script src="../../assets/scripts/app.js"></script>  
    <script type="text/javascript">
        jQuery(document).ready(function() {
            App.init();                      
        });
    </script>
	<script type="text/javascript" src="../../assets/scripts/blog.js"></script>
    <!-- END PAGE LEVEL JAVASCRIPTS -->
</body>
<!-- END BODY -->
</html>
